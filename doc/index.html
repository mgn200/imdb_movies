<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  File: README
  
    &mdash; Documentation by YARD 0.9.12
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  pathId = "README";
  relpath = '';
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="_index.html">Index</a> &raquo; 
    <span class="title">File: README</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><div id='filecontents'>
<h1 id="label-ImdbPlayfield">ImdbPlayfield</h1>

<p>ImdbPlayfield is a Ruby study project, built with the mentoring help of
mkdev.me team member. It covers everything a good junior-level developer
should know about Ruby. It uses imdb top 250 as a playground for Ruby
features and design patterns.</p>

<p>It implements:  - Parsing text files, creating objects from data  - Sorting
and filtering collections, data manipulation(with movies)  - Playing around
with classes relationships(movies, theatres and useful modules.  - Test
Driven Development  - DSL  - Basic objects design with composition and
inheritance  - Scrapping with Nokogiri  - Working with TMDB.com API  -
Using HAML with bootstrap template to create html page of top 250 movies  -
Learning correct documentation and project structure</p>

<h2 id="label-Install">Install</h2>

<p>Install gem and don&#39;t forget to require it <code>ruby gem install
imdb_playfield </code> <code>ruby require &#39;imdb_playfield&#39; </code></p>

<h2 id="label-Usage">Usage</h2>

<h3 id="label-Basic+usage">Basic usage</h3>

<p>You have several options to play around, such as filtering and sorting
movies from movies.txt <code>ruby imdb_movies =
ImdbPlayfield::MovieCollection.new imdb_movies.filter(country:
&#39;USA&#39;)                   # returns array of movies made in USA
imdb_movies.filter(rating: 8.2)                      # returns array of
movies with rating of 8.2
imdb_movies.sample(10).has_genre?(&#39;Comedy&#39;)          # returns true
of false if any comedy movie present in array imdb_movie_.filter(period:
:ancient)                 # returns all movies that were made before 1945
</code></p>

<p>Creating online and offline movie theatres: “`ruby netflix =
ImdbPlayfield::Netflix.new<br> theatre = ImdbPlayfield::Theatre.new</p>

<p>netflix.cash # shows how much cash Netflix has netflix.pay # puts cash to
balance netflix.how_much &#39;The Terminator&#39; # returns price for movie
in dollars netflix.show &#39;The Terminator&#39; # “shows” movie, withdraw
it&#39;s price from balance</p>

<p>theatre.when? &#39;The Terminator&#39; # returns time when movie will be
shown theatre.buy_ticket(&#39;The Terminator&#39;, hall: :red) # buy ticket
and withdraw it&#39;s price from balance <code> Creating complex filters
for Netflix: </code>ruby netflix = ImdbPlayfield::Netflix.new
netflix.define_filter(:new_sci_fi) {
!movie.title.include?(&#39;Terminator&#39;) &amp;&amp;
movie.genre.include?(&#39;Action&#39;) &amp;&amp; movie.year &gt; 2003 }</p>

<h1 id="label-create+and+save+new_sci_file+filter">create and save new_sci_file filter</h1>

<p>netflix.show(new_sci_fi: true) # returns filtered array of movies “`</p>

<p>Creating schedule for movie theatre with DSL: “`ruby theatre =
ImdbPlayfield::Theater.new do # creates a Theatre with given schedule  hall
:red, title: &#39;Красный зал&#39;, places: 100  hall :blue, title:
&#39;Синий зал&#39;, places: 50  hall :green, title: &#39;Зелёный зал
(deluxe)&#39;, places: 12</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_period'>period</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>09:00</span><span class='tstring_end'>&#39;</span></span><span class='op'>..</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>11:00</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>do</span>
  <span class='id identifier rubyid_description'>description</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Morning session</span><span class='tstring_end'>&#39;</span></span>
  <span class='id identifier rubyid_filters'>filters</span> <span class='label'>genre:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Comedy</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>year:</span> <span class='int'>1900</span><span class='op'>..</span><span class='int'>1980</span>

<span class='kw'>end</span>

<span class='id identifier rubyid_period'>period</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>11:00</span><span class='tstring_end'>&#39;</span></span><span class='op'>..</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>16:00</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>do</span>
  <span class='id identifier rubyid_description'>description</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Noon non-old dramas</span><span class='tstring_end'>&#39;</span></span>
  <span class='id identifier rubyid_filters'>filters</span> <span class='label'>genre:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Drama</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>exclude_period:</span> <span class='symbol'>:ancient</span>
<span class='kw'>end</span>
</code></pre>

<p>end</p>

<p>theatre.info # prints current schedule “`</p>

<p>Create html page of movies from Netflix <code>ruby netflix =
ImdbPlayfield::Netflix.new netflix.build_html                              
# creates and index.html file in data/views/ </code></p>

<h3 id="label-Full+actions+for+every+object">Full actions for every object</h3>

<p>MovieCollection is the movies container from movies.txt file (prepared list
of top 250 imdb movies) It stores collection methods and creates Movies
objects based on movie attributes.</p>

<p>Default movie attributes are: link, title, year, country, date, genre,
duration, rating, director, actors.</p>

<p>MovieCollection methods: “`ruby movies_collection =
ImdbPlayfield::MovieCollection.new</p>

<h1 id="label-Array+of+every+parsed+movie+from+movies.txt">Array of every parsed movie from movies.txt</h1>

<p>movies_collection.all</p>

<h1 id="label-Sort+movies+array+by+given+attribute+name">Sort movies array by given attribute name</h1>

<p>movies_collection.sort_by(:director)</p>

<h1 id="label-Filters+movies+collection+with+hash+parameters">Filters movies collection with hash parameters</h1>

<h1 id="label-Params+are+default+movie+attributes">Params are default movie attributes</h1>

<h1 id="label-You+can+also+use+exclude_attribute+filter">You can also use exclude_attribute filter</h1>

<p>movies_collection.filter(period: :new, exclude_country: &#39;USA&#39;,
genre: &#39;Action&#39;)</p>

<h1 id="label-Pick+one+more+from+given+array">Pick one more from given array</h1>

<h1 id="label-The+more+rating+movie+has-2C+the+more+-22weight-22+it+has+in+comparison+to+other">The more rating movie has, the more “weight” it has in comparison to other</h1>

<h1 id="label-Higher+rated+movies+will+be+a+bit+more+likely+to+be+selected">Higher rated movies will be a bit more likely to be selected</h1>

<p>movies_collection.pick_movie movies_collection.sample(10)</p>

<h1 id="label-Counts+attribute+values+and+returns+a+hash.+For+example-3A">Counts attribute values and returns a hash. For example:</h1>

<h1 id="label-7B+-27Comedy-27+-3D-3E+28-2C+-27Action-27+-3D-3E+15-2C+-27Drama-27+-3D-3E+89-2C+...+-7D">{ &#39;Comedy&#39; =&gt; 28, &#39;Action&#39; =&gt; 15, &#39;Drama&#39; =&gt; 89, … }</h1>

<p>movies_collection.stats(:genre)</p>

<h1 id="label-or">or</h1>

<p>movies_collection.stats(:director) “`</p>

<p>Movie is an abstract class for every movie parsed and created from
movies.txt It has 4 different types, based on film year: AncientMovie,
ModernMovie, NewMovie, ClassicMovie. Every movie is created when
MovieCollection is initialized.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_movie'>movie</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="ImdbPlayfield.html" title="ImdbPlayfield (module)">ImdbPlayfield</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="ImdbPlayfield/MovieCollection.html" title="ImdbPlayfield::MovieCollection (class)">MovieCollection</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="ImdbPlayfield/MovieCollection.html#initialize-instance_method" title="ImdbPlayfield::MovieCollection#initialize (method)">new</a></span></span><span class='period'>.</span><span class='id identifier rubyid_all'><span class='object_link'><a href="ImdbPlayfield/MovieCollection.html#all-instance_method" title="ImdbPlayfield::MovieCollection#all (method)">all</a></span></span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>

<span class='id identifier rubyid_movie'>movie</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>        <span class='comment'># Returns a string with basic movie info
</span><span class='id identifier rubyid_movie'>movie</span><span class='period'>.</span><span class='id identifier rubyid_month'>month</span>       <span class='comment'># &quot;January&quot;
</span><span class='id identifier rubyid_movie'>movie</span><span class='period'>.</span><span class='id identifier rubyid_price'>price</span>       <span class='comment'># 10 (in dollars)
</span></code></pre>

<p>Netflix is a representation of online movie theater.</p>

<pre class="code ruby"><code class="ruby">netflix = ImdbPlayfield::Netflix.new

# Balance is 0 dollars by default
# You can put money and use it to pay for movies
netflix.pay 10
netflix.balance       # 10

# You can order movies, if you have enough money
# It will use #pick_movie from MovieCollection
netflix.show(year: 2000, genre: &#39;Drama&#39;)

# You can also use more advanced filtering and save your filters
netflix.show { |movie| !movie.title.include?(&#39;Terminator&#39;) &amp;&amp; movie.genre.include?(&#39;Action&#39;) &amp;&amp; movie.year &gt; 2003 }
netflix.define_filter(:new_sci_fi) { movie.period: :new, movie.genre: &#39;Sci-Fi&#39; }
netflix.show(new_sci_fi: true)

# Returns the price for the given movie title
# netflix.show will raise &#39;Insufficient funds&#39; ArgumentError, if you don&#39;t have enough money on balance
netflix.how_much? &#39;The Terminator&#39;        # 10

# Start builds an html page
# Make sure you run bin/fetch_imdb and bin/fetch_tmdb before build_html
# as the method uses additional data from YML files generated by these external requests
# (they are covered in IMDBScrapper and TMDBApi classes)

netflix.build_html        # creates index.html in data/views

# Some DSL for more convenient filters
netflix.by_genre.comedy # returns all the comedies
netflix.by_country.usa # returns all movies made in USA
</code></pre>

<p>Theatre is a representation of real world theater.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_theater'>theater</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="ImdbPlayfield.html" title="ImdbPlayfield (module)">ImdbPlayfield</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="ImdbPlayfield/Theatre.html" title="ImdbPlayfield::Theatre (class)">Theatre</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="ImdbPlayfield/Theatre.html#initialize-instance_method" title="ImdbPlayfield::Theatre#initialize (method)">new</a></span></span>

<span class='comment'># USE DSL to build your own schedule
</span><span class='comment'># It uses default one otherwise. The time holes(i.e night time) will be considered as session break
</span><span class='comment'># If your schedule periods intersect with each other or have holes between first and last of them - an error will be range_in_seconds
</span>
<span class='id identifier rubyid_theatre'>theatre</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="ImdbPlayfield.html" title="ImdbPlayfield (module)">ImdbPlayfield</a></span></span><span class='op'>::</span><span class='const'>Theater</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='kw'>do</span>                              
    <span class='id identifier rubyid_hall'>hall</span> <span class='symbol'>:red</span><span class='comma'>,</span> <span class='label'>title:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Красный зал</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>places:</span> <span class='int'>100</span>
    <span class='id identifier rubyid_hall'>hall</span> <span class='symbol'>:blue</span><span class='comma'>,</span> <span class='label'>title:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Синий зал</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>places:</span> <span class='int'>50</span>
    <span class='id identifier rubyid_hall'>hall</span> <span class='symbol'>:green</span><span class='comma'>,</span> <span class='label'>title:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Зелёный зал (deluxe)</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>places:</span> <span class='int'>12</span>

    <span class='id identifier rubyid_period'>period</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>09:00</span><span class='tstring_end'>&#39;</span></span><span class='op'>..</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>11:00</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>do</span>
      <span class='id identifier rubyid_description'>description</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Morning session</span><span class='tstring_end'>&#39;</span></span>
      <span class='id identifier rubyid_filters'>filters</span> <span class='label'>genre:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Comedy</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>year:</span> <span class='int'>1900</span><span class='op'>..</span><span class='int'>1980</span>
      <span class='id identifier rubyid_price'>price</span> <span class='int'>10</span>
      <span class='id identifier rubyid_hall'>hall</span> <span class='symbol'>:red</span><span class='comma'>,</span> <span class='symbol'>:blue</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_period'>period</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>11:00</span><span class='tstring_end'>&#39;</span></span><span class='op'>..</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>16:00</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>do</span>
      <span class='id identifier rubyid_description'>description</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Special</span><span class='tstring_end'>&#39;</span></span>
      <span class='id identifier rubyid_title'>title</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>The Terminator</span><span class='tstring_end'>&#39;</span></span>
      <span class='id identifier rubyid_price'>price</span> <span class='int'>50</span>
      <span class='id identifier rubyid_hall'>hall</span> <span class='symbol'>:green</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_period'>period</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>16:00</span><span class='tstring_end'>&#39;</span></span><span class='op'>..</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>20:00</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>do</span>
      <span class='id identifier rubyid_description'>description</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Evening session</span><span class='tstring_end'>&#39;</span></span>
      <span class='id identifier rubyid_filters'>filters</span> <span class='label'>genre:</span> <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Action</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Drama</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='label'>year:</span> <span class='int'>2007</span><span class='op'>..</span><span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span><span class='period'>.</span><span class='id identifier rubyid_year'>year</span>
      <span class='id identifier rubyid_price'>price</span> <span class='int'>20</span>
      <span class='id identifier rubyid_hall'>hall</span> <span class='symbol'>:red</span><span class='comma'>,</span> <span class='symbol'>:blue</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_period'>period</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>19:00</span><span class='tstring_end'>&#39;</span></span><span class='op'>..</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>22:00</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>do</span>
      <span class='id identifier rubyid_description'>description</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Evening session for movie fans</span><span class='tstring_end'>&#39;</span></span>
      <span class='id identifier rubyid_filters'>filters</span> <span class='label'>year:</span> <span class='int'>1900</span><span class='op'>..</span><span class='int'>1945</span><span class='comma'>,</span> <span class='label'>exclude_country:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>USA</span><span class='tstring_end'>&#39;</span></span>
      <span class='id identifier rubyid_price'>price</span> <span class='int'>30</span>
      <span class='id identifier rubyid_hall'>hall</span> <span class='symbol'>:green</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

<span class='comment'># Convenietnly pronts schedule info
</span><span class='id identifier rubyid_theatre'>theatre</span><span class='period'>.</span><span class='id identifier rubyid_info'>info</span>

<span class='comment'># Buy ticket for the given movie. Hall must be specified if movie can be seen in different halls.
</span><span class='id identifier rubyid_theatre'>theatre</span><span class='period'>.</span><span class='id identifier rubyid_buy_ticket'>buy_ticket</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>The Terminator</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='symbol'>:red</span><span class='rparen'>)</span>

<span class='comment'># Shows number of cash in the current theatre
</span><span class='id identifier rubyid_theatre'>theatre</span><span class='period'>.</span><span class='id identifier rubyid_cash'>cash</span>

<span class='comment'># Returns periods if time, when the given movie is shown
</span><span class='comment'># Puts a message, when movie is not shown in the current schedule
</span><span class='comment'># or is not found in the MovieCollection.all
</span><span class='id identifier rubyid_theatre'>theatre</span><span class='period'>.</span><span class='id identifier rubyid_when?'>when?</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>The Terminator</span><span class='tstring_end'>&#39;</span></span>

<span class='comment'># Show all halls
</span><span class='id identifier rubyid_theatre'>theatre</span><span class='period'>.</span><span class='id identifier rubyid_halls'>halls</span>
</code></pre>

<p>IMDBScrapper and TMDBApi are “data miners” that collect data needed for
netflix.build_html method. It uses this data in haml and bootstrap template
file in data/views/index.haml. Info is stored in YML files at
data/movies_imdb_info.yml and data/movies_tmdb_info.yml.</p>

<p>You can use HamlBuilder outside of Netflix, to render html when you need
it.</p>

<p>Run rake tasks to create yml files: <code>rake fetch_imdb</code> and
<code>rake fetch_tmdb</code> After that you can:</p>

<pre class="code ruby"><code class="ruby"><span class='const'><span class='object_link'><a href="ImdbPlayfield.html" title="ImdbPlayfield (module)">ImdbPlayfield</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="ImdbPlayfield/HamlBuilder.html" title="ImdbPlayfield::HamlBuilder (class)">HamlBuilder</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="ImdbPlayfield/HamlBuilder.html#initialize-instance_method" title="ImdbPlayfield::HamlBuilder#initialize (method)">new</a></span></span><span class='period'>.</span><span class='id identifier rubyid_build_html'><span class='object_link'><a href="ImdbPlayfield/HamlBuilder.html#build_html-instance_method" title="ImdbPlayfield::HamlBuilder#build_html (method)">build_html</a></span></span>     <span class='comment'># creates data/views/index.html
</span></code></pre>

<h2 id="label-Supported+Ruby+versions">Supported Ruby versions</h2>

<p>This app supports Ruby &gt;= 2.3.0</p>
</div></div>

      <div id="footer">
  Generated on Wed Nov 29 19:34:11 2017 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.12 (ruby-2.4.1).
</div>

    </div>
  </body>
</html>